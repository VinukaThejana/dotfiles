#!/bin/bash

source ~/bin/arduino.devices

name=$(printf "%s\n" "${names[@]}" | fzf --prompt "Select a board: ")
index=$(printf "%s\n" "${names[@]}" | grep -nx "$name" | cut -d: -f1)

if [[ -n "$index" && "$index" -ge 1 && "$index" -le ${#names[@]} ]]; then
    index=$((index - 1))
    device="${devices[$index]}"

    esptool.py --chip esp32 --port "$device" erase_flash
fi
